name: Mirror Parity PRs
on:
  schedule:
    - cron: '0 * * * *'  # check hourly
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Mirror upstream PRs
        run: |
          git remote add upstream https://github.com/paritytech/polkadot-sdk.git
          git fetch upstream
          for pr in $(gh pr list -R paritytech/polkadot-sdk --state open --json number --jq '.[].number'); do
            git fetch upstream pull/$pr/head:pr-$pr || true
            git push origin pr-$pr || true
          done
